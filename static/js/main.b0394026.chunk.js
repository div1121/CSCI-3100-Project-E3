(this["webpackJsonpmagic-maze"]=this["webpackJsonpmagic-maze"]||[]).push([[0],{187:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(27),i=a.n(s),o=a(9),c=(a(79),a(80),a(190)),l=a(191),d=a(192),u=a(195),h=a(194),j=a(19),b=a.n(j),p=a(30),y=a(189),m=a(193),f=a(72),v=a.n(f).a.create({baseURL:"https://magic-maze-backend.herokuapp.com"}),O=a(47),x=a.n(O),g=a(1);function w(e){var t=e.setUserID,a=e.setUsername,r=e.name,n=e.email,s=e.password,i=function(){var e=Object(p.a)(b.a.mark((function e(i){var o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.preventDefault(),o=!1,0!=r.length){e.next=6;break}alert("Name is empty!"),e.next=33;break;case 6:if(0!=n.length){e.next=10;break}alert("Email is empty!"),e.next=33;break;case 10:if(0!=x.a.isEmail(n)){e.next=14;break}alert("Email does not exist!"),e.next=33;break;case 14:if(0!=s.length){e.next=18;break}alert("Password is empty!"),e.next=33;break;case 18:if(!(s.length<8)){e.next=22;break}alert("Password should contain at least 8 letters!"),e.next=33;break;case 22:return e.prev=22,e.next=25,v.post("/loginAccount",{email:n}).then((function(e){0==e.data.length?o=!0:alert("This email has been used for registration. You may register with another email or login.")}));case 25:if(!o){e.next=28;break}return e.next=28,v.post("/createAccount",{name:r,email:n,password:s}).then((function(e){t(e.data._id),a(e.data.name),sessionStorage.setItem("userID",e.data[0]._id),sessionStorage.setItem("username",e.data[0].name),alert("Register successfully")}));case 28:e.next=33;break;case 30:e.prev=30,e.t0=e.catch(22),alert("Internal error");case 33:case"end":return e.stop()}}),e,null,[[22,30]])})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsx)(y.a,{variant:"secondary",onClick:i,children:"Register"})}function k(e){var t=e.setUserID,a=e.setUsername,r=e.email,n=e.password,s=function(){var e=Object(p.a)(b.a.mark((function e(s){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.prev=1,e.next=4,v.post("/loginAccount",{email:r,password:n}).then((function(e){0==e.data.length?alert("Invalid email or password"):(t(e.data[0]._id),a(e.data[0].name),sessionStorage.setItem("userID",e.data[0]._id),sessionStorage.setItem("username",e.data[0].name),alert("Login successfully"))}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),alert("Internal Error");case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsx)(y.a,{variant:"secondary",onClick:s,children:"Login"})}function P(e){var t=e.setUserID,a=e.setUsername,r=function(){var e=Object(p.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t(null),a(null),sessionStorage.clear(),alert("Logout successfully")}catch(r){alert("Failed to connect")}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(g.jsx)(y.a,{size:"lg",variant:"secondary",onClick:r,children:"Log out"})}function M(e){var t=e.setUserID,a=e.setUsername,r=n.a.useState("Login"),s=Object(o.a)(r,2),i=s[0],c=s[1],l=n.a.useState(""),d=Object(o.a)(l,2),u=d[0],h=d[1],j=n.a.useState(""),b=Object(o.a)(j,2),p=b[0],y=b[1],m=n.a.useState(""),f=Object(o.a)(m,2),v=f[0],O=f[1];return n.a.useEffect((function(){h(""),y(""),O("")}),[i]),Object(g.jsxs)("div",{className:"login_form",children:["Register"===i?Object(g.jsx)("input",{type:"name",placeholder:"name",value:u,onChange:function(e){return h(e.target.value)},className:"form_input"}):Object(g.jsx)(g.Fragment,{}),Object(g.jsx)("input",{type:"email",placeholder:"email",value:p,onChange:function(e){return y(e.target.value)},className:"form_input"}),Object(g.jsx)("input",{type:"password",placeholder:"password",value:v,onChange:function(e){return O(e.target.value)},className:"form_input"}),"Login"===i?Object(g.jsx)(k,{setUserID:t,setUsername:a,email:p,password:v}):Object(g.jsx)(w,{setUserID:t,setUsername:a,name:u,email:p,password:v}),Object(g.jsxs)("div",{children:[Object(g.jsx)("span",{children:"You may also "}),Object(g.jsx)("a",{href:"#",onClick:function(){c((function(e){return"Login"===e?"Register":"Login"}))},children:"Login"===i?"register a new account":"go to login"})]})]})}function S(e){var t=e.setUserID,a=e.setUsername,r=n.a.useState(!1),s=Object(o.a)(r,2),i=s[0],c=s[1];return Object(g.jsxs)("div",{children:[Object(g.jsx)(y.a,{size:"lg",variant:"secondary",onClick:function(){return c(!0)},children:"Login"}),Object(g.jsxs)(m.a,{show:i,onHide:function(){return c(!1)},children:[Object(g.jsx)(m.a.Header,{closeButton:!0,children:Object(g.jsx)(m.a.Title,{children:"Join us!"})}),Object(g.jsx)(m.a.Body,{children:Object(g.jsx)(M,{setUserID:t,setUsername:a})})]})]})}function _(e){var t=e.userID,a=e.password,r=e.newPassword,n=e.reNewPassword,s=e.setShow,i=function(){var e=Object(p.a)(b.a.mark((function e(i){var o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=!1,i.preventDefault(),e.prev=2,e.next=5,v.post("/loginAccount",{_id:t,password:a}).then((function(e){0==e.data.length?alert("Password is wrong"):0==r.length?alert("New password is empty!"):r.length<8?alert("New password should contain at least 8 letters!"):r!=n?alert("Re-entered new password is not same to new password!"):o=!0}));case 5:if(!o){e.next=8;break}return e.next=8,v.post("/updateAccount",{_id:t,password:r}).then((function(e){1==e.data.ok&&alert("Password is updated"),s(!1)}));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),alert("Internal Error");case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsx)(y.a,{variant:"primary",onClick:i,children:"Confirm"})}function C(e){var t=e.userID,a=n.a.useState(!1),r=Object(o.a)(a,2),s=r[0],i=r[1],c=n.a.useState(""),l=Object(o.a)(c,2),d=l[0],u=l[1],h=n.a.useState(""),j=Object(o.a)(h,2),b=j[0],p=j[1],f=n.a.useState(""),v=Object(o.a)(f,2),O=v[0],x=v[1];return n.a.useEffect((function(){u(""),p(""),x("")}),[s]),Object(g.jsxs)("div",{children:[Object(g.jsx)(y.a,{size:"md",variant:"secondary",onClick:function(){return i(!0)},children:"Change password"}),Object(g.jsxs)(m.a,{show:s,onHide:function(){return i(!1)},children:[Object(g.jsx)(m.a.Header,{closeButton:!0,children:Object(g.jsx)(m.a.Title,{children:"Change password"})}),Object(g.jsx)(m.a.Body,{children:Object(g.jsxs)("form",{children:[Object(g.jsx)("div",{children:Object(g.jsx)("input",{type:"password",value:d,placeholder:"Current password",onChange:function(e){return u(e.target.value)},className:"form_input"})}),Object(g.jsx)("div",{children:Object(g.jsx)("input",{type:"password",value:b,placeholder:"New password",onChange:function(e){return p(e.target.value)},className:"form_input"})}),Object(g.jsx)("div",{children:Object(g.jsx)("input",{type:"password",value:O,placeholder:"Re-enter new password",onChange:function(e){return x(e.target.value)},className:"form_input"})})]})}),Object(g.jsx)(m.a.Footer,{children:Object(g.jsx)(_,{userID:t,password:d,newPassword:b,reNewPassword:O,setShow:i})})]})]})}function D(e){var t=e.userID,a=e.username,r=(e.setUsername,n.a.useState(!1)),s=Object(o.a)(r,2),i=s[0],c=s[1];return Object(g.jsxs)("div",{children:[Object(g.jsx)(y.a,{size:"lg",variant:"secondary",onClick:function(){return c(!0)},children:"Profile"}),Object(g.jsxs)(m.a,{show:i,onHide:function(){return c(!1)},children:[Object(g.jsx)(m.a.Header,{closeButton:!0,children:Object(g.jsx)(m.a.Title,{children:"Player profile"})}),Object(g.jsxs)(m.a.Body,{children:[Object(g.jsxs)("div",{children:["Name: ",a]}),Object(g.jsx)("div",{children:"Symbol: #"}),Object(g.jsx)("div",{children:"Game record: "})]}),Object(g.jsxs)(m.a.Footer,{children:[Object(g.jsx)(C,{userID:t}),Object(g.jsx)(y.a,{variant:"primary",children:"Save changes"})]})]})]})}function I(e){var t=e.userID,a=e.username,r=e.setUserID,n=e.setUsername;return Object(g.jsx)("div",{children:Object(g.jsxs)(u.a,{className:"py-4",bg:"dark",variant:"dark",children:[Object(g.jsx)(u.a.Brand,{href:"https://github.com/luyou00001/CSCI-3100-Project-E3\t",children:"Magic Maze"}),Object(g.jsx)(h.a,{children:Object(g.jsx)(u.a.Text,{children:"\u2022 A game created by CSCI3100 Project Group E3"})}),Object(g.jsx)(h.a,{className:"ml-auto"}),null===t?Object(g.jsx)(h.a.Link,{href:"#home",children:Object(g.jsx)(S,{setUserID:r,setUsername:n})}):Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(u.a.Brand,{children:["Welcome ",a]}),Object(g.jsx)(h.a.Link,{href:"#home",children:Object(g.jsx)(D,{userID:t,username:a,setUsername:n})}),Object(g.jsx)(h.a.Link,{href:"#home",children:Object(g.jsx)(P,{setUserID:r,setUsername:n})})]})]})})}var U=a(15),N=a(16),H=a(18),E=a(17),W=function(e){Object(H.a)(a,e);var t=Object(E.a)(a);function a(){return Object(U.a)(this,a),t.apply(this,arguments)}return Object(N.a)(a,[{key:"render",value:function(){return Object(g.jsx)("div",{className:"chat_room",children:Object(g.jsx)("h1",{children:"Chat room"})})}}]),a}(n.a.Component),B=a(8),K=a(74);a.n(K).a.start();var L=function(e){Object(H.a)(a,e);var t=Object(E.a)(a);function a(e){var r;return Object(U.a)(this,a),(r=t.call(this,e)).state={board:[],entityStates:{entrance:"\u256c",empty:"\u3000",player:"\u2642"}},r.setPlayerPosition=r.setPlayerPosition.bind(Object(B.a)(r)),r.setBoard=r.setBoard.bind(Object(B.a)(r)),r}return Object(N.a)(a,[{key:"componentWillMount",value:function(){for(var e=this,t=this.props,a=t.boardHeight,r=t.boardWidth,n=t.areaHeight,s=t.areaWidth,i=t.playerPosition,o=[],c=0;c<a;c++){for(var l=[],d=0;d<r;d++){for(var u=[],h=0;h<n;h++){for(var j=[],b=0;b<s;b++)0===b&&0===h||b===s-1&&0===h||b===s-1&&h===n-1||0===b&&h===n-1?j.push(this.state.entityStates.entrance):i.x===d*s+b&&i.y===c*n+h?j.push(this.state.entityStates.player):j.push(this.state.entityStates.empty);u.push(j)}l.push(u)}o.push(l)}this.setState({board:o,areaHeight:n,areaWidth:s,playerPosition:i},(function(){e.setPlayerPosition(i)}))}},{key:"setPlayerPosition",value:function(e){var t=this.state,a=t.board,r=t.areaHeight,n=t.areaWidth,s=e.x,i=e.y;a[Math.floor(i/r)][Math.floor(s/n)][i%r][s%n]=this.state.entityStates.player,this.setState({board:a})}},{key:"componentWillReceiveProps",value:function(e){e===this.props||this.setBoard(e)}},{key:"setBoard",value:function(e){var t=this,a=e.playerPosition,r=e.prevPlayerPos,n=e.areaHeight,s=e.areaWidth,i=this.state.board,o=r.x,c=r.y,l=a.x,d=a.y;i[Math.floor(c/n)][Math.floor(o/s)][c%n][o%s]=this.state.entityStates.empty,i[Math.floor(d/n)][Math.floor(l/s)][d%n][l%s]=this.state.entityStates.player,this.setState({board:i,playerPosition:a},(function(){t.setPlayerPosition(a)}))}},{key:"render",value:function(){var e=this.state.board;return console.log(e),Object(g.jsx)("div",{children:e.map((function(e,t){return Object(g.jsx)("tr",{children:e.map((function(e,a){var r="blue",n="yellow";return(t+a)%2==0&&(r="yellow",n="blue"),Object(g.jsx)("td",{style:{textAlign:"center",verticalAlign:"middle",backgroundColor:n,color:r},children:Object(g.jsx)("table",{className:"area",cellSpacing:"0",id:"table",border:"3px",width:"100",height:"100",textAlign:"center",children:Object(g.jsx)("tbody",{children:e.map((function(e){return Object(g.jsx)("tr",{children:e.map((function(e){return Object(g.jsx)("td",{className:"area",children:e})}))})}))})})})}))})}))})}}]),a}(r.Component),R=(a(184),a(23)),A=function(e){Object(H.a)(a,e);var t=Object(E.a)(a);function a(e){var r;return Object(U.a)(this,a),(r=t.call(this,e)).state={win:!1,showGameBoard:!1,boardHeight:0,boardWidth:0,areaHeight:0,areaWidth:0,randomEntrances:[],randomPositions:[],playerPosition:{x:0,y:0},prevPlayerPos:{x:0,y:0},totalMoves:0},r.initializeBoardPlayer=r.initializeBoardPlayer.bind(Object(B.a)(r)),r.startGame=r.startGame.bind(Object(B.a)(r)),r.setEntrances=r.setEntrances.bind(Object(B.a)(r)),r.countTotalMoves=r.countTotalMoves.bind(Object(B.a)(r)),r.handleKeyUp=r.handleKeyUp.bind(Object(B.a)(r)),r.handleKeyDown=r.handleKeyDown.bind(Object(B.a)(r)),r.handleKeyRight=r.handleKeyRight.bind(Object(B.a)(r)),r.handleKeyLeft=r.handleKeyLeft.bind(Object(B.a)(r)),r.makeMove=r.makeMove.bind(Object(B.a)(r)),r}return Object(N.a)(a,[{key:"componentWillMount",value:function(){this.initializeBoardPlayer()}},{key:"initializeBoardPlayer",value:function(){var e=this,t={x:Math.floor(2.5),y:Math.floor(2.5)},a={x:Math.floor(2.5),y:Math.floor(2.5)};this.setState({boardHeight:5,boardWidth:5,areaWidth:5,areaHeight:5,playerPosition:t,prevPlayerPos:a,showGameBoard:!0},(function(){e.startGame()}))}},{key:"startGame",value:function(){this.setEntrances()}},{key:"setEntrances",value:function(){for(var e,t=this.state,a=t.randomEntrances,r=t.boardHeight,n=t.boardWidth,s=0;s<r;s++)for(var i=0;i<n;i++){a.push([]);for(var o=[[1,-1],[1,0],[0,1],[-1,1]],c=4;c>0;){var l=i+o[e=Math.floor(Math.random()*c)][0],d=s+o[e][1];l<0||l>=r||d<0||d>=r?(a[i+s*n].push([]),a[i+s*n][4-c].push(i),a[i+s*n][4-c].push(s)):(a[i+s*n].push([]),a[i+s*n][4-c].push(l),a[i+s*n][4-c].push(d)),c--,o.splice(e,1)}}this.setState({randomEntrances:a})}},{key:"countTotalMoves",value:function(){this.setState({totalMoves:++this.state.totalMoves})}},{key:"handleKeyUp",value:function(e){e.preventDefault();var t=this.state,a=t.playerPosition,r=t.areaHeight;Number(a.y)%r-1>=0&&this.makeMove(a.x,a.y-1)}},{key:"handleKeyDown",value:function(e){e.preventDefault();var t=this.state,a=t.playerPosition,r=t.areaHeight;Number(a.y)%r+1<r&&this.makeMove(a.x,a.y+1)}},{key:"handleKeyRight",value:function(e){e.preventDefault();var t=this.state,a=t.playerPosition,r=t.areaWidth;Number(a.x)%r+1<r&&this.makeMove(a.x+1,a.y)}},{key:"handleKeyLeft",value:function(e){e.preventDefault();var t=this.state,a=t.playerPosition,r=t.areaWidth;Number(a.x)%r-1>=0&&this.makeMove(a.x-1,a.y)}},{key:"makeMove",value:function(e,t){var a=this.state,r=a.playerPosition,n=a.randomEntrances,s=a.boardHeight,i=a.boardWidth,o=a.areaWidth,c=a.areaHeight,l=a.win,d={x:r.x,y:r.y},u=e%o,h=t%c;if(0===u&&0===h||u===o-1&&0===h||u===o-1&&h===c-1||0===u&&h===c-1){var j;j=0===u&&0===h?0:u===o-1&&0===h?1:u===o-1&&h===c-1?2:3;var b=Math.floor(e/o),p=Math.floor(t/c),y=n[b+p*i][j][0]*o+Math.floor(o/2),m=n[b+p*i][j][1]*c+Math.floor(c/2);r.x=y,r.y=m,Math.floor(y/o)===i-1&&Math.floor(m/c)===s-1&&(l=!0)}else r.x=e,r.y=t;this.setState({playerPosition:r,prevPlayerPos:d,win:l}),this.countTotalMoves()}},{key:"render",value:function(){var e=this.state,t=e.playerPosition,a=e.randomEntrances,r=e.boardWidth,n=e.areaWidth,s=e.areaHeight,i=e.totalMoves,o=e.win,c="*GM Mode* Coordinates: ("+t.x+", "+t.y+") ",l=Math.floor(t.x/n)+Math.floor(t.y/s)*r;if(c+="Entrance: ",a[l])for(var d=0;d<4;d++)c+="("+a[l][d][0]+", "+a[l][d][1]+") ";return o&&(o=!1,alert("You win! Total moves: "+i)),Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{className:"status",children:c}),Object(g.jsx)(R.b,{keyEventName:R.a,keyValue:"ArrowUp",onKeyHandle:this.handleKeyUp}),Object(g.jsx)(R.b,{keyEventName:R.a,keyValue:"ArrowDown",onKeyHandle:this.handleKeyDown}),Object(g.jsx)(R.b,{keyEventName:R.a,keyValue:"ArrowRight",onKeyHandle:this.handleKeyRight}),Object(g.jsx)(R.b,{keyEventName:R.a,keyValue:"ArrowLeft",onKeyHandle:this.handleKeyLeft}),this.state.showGameBoard&&Object(g.jsx)(L,{randomPositions:this.state.randomPositions,boardWidth:this.state.boardWidth,boardHeight:this.state.boardHeight,areaWidth:this.state.areaWidth,areaHeight:this.state.areaHeight,playerPosition:this.state.playerPosition,prevPlayerPos:this.state.prevPlayerPos,totalMoves:this.state.totalMoves})," "]})}}]),a}(r.Component),z=function(e){Object(H.a)(a,e);var t=Object(E.a)(a);function a(){return Object(U.a)(this,a),t.apply(this,arguments)}return Object(N.a)(a,[{key:"render",value:function(){var e="Ready";return this.props.isready&&(e="Cancel"),Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{children:this.props.playername}),Object(g.jsx)("td",{children:Object(g.jsx)("button",{onClick:this.props.handleready,children:e})})]})}}]),a}(r.Component),G=function(e){Object(H.a)(a,e);var t=Object(E.a)(a);function a(e){var r;return Object(U.a)(this,a),(r=t.call(this,e)).state={room_name:r.props.roomname,player_list:r.props.player_list,player_num:r.props.player_num,ready_num:0,ready_state:Array(4).fill(!1)},r.addready=r.addready.bind(Object(B.a)(r)),r.minusready=r.minusready.bind(Object(B.a)(r)),r}return Object(N.a)(a,[{key:"addready",value:function(e){var t=this.state.ready_state;t[e]=!0;var a=this.state.ready_num+1;this.setState({ready_num:a,ready_state:t})}},{key:"minusready",value:function(e){var t=this.state.ready_state;t[e]=!1;var a=this.state.ready_num-1;a<0||this.setState({ready_num:a,ready_state:t})}},{key:"render",value:function(){for(var e=this,t=[0,0,0,0],a=function(a){e.state.ready_state[a]?t[a]=function(){return e.minusready(a)}:t[a]=function(){return e.addready(a)}},r=0;r<4;r++)a(r);return Object(g.jsxs)("div",{children:[Object(g.jsx)("h1",{children:this.props.room_name}),Object(g.jsxs)("table",{children:[Object(g.jsx)(z,{isready:this.state.ready_state[0],playername:this.props.player_list[0],handleready:t[0]}),Object(g.jsx)(z,{isready:this.state.ready_state[1],playername:this.props.player_list[1],handleready:t[1]}),Object(g.jsx)(z,{isready:this.state.ready_state[2],playername:this.props.player_list[2],handleready:t[2]}),Object(g.jsx)(z,{isready:this.state.ready_state[3],playername:this.props.player_list[3],handleready:t[3]})]}),Object(g.jsxs)("h2",{children:["Number of ready: ",this.state.ready_num]})]})}}]),a}(r.Component);function T(e){var t=e.setMode;return Object(g.jsx)(y.a,{size:"lg",variant:"primary",onClick:function(){t("Demo")},children:"Demo"})}function F(e){var t=e.setMode;return Object(g.jsx)(y.a,{size:"lg",variant:"primary",onClick:function(){t("CustomRoom")},children:"Custom room"})}var J=function(e){Object(H.a)(a,e);var t=Object(E.a)(a);function a(e){var r;return Object(U.a)(this,a),(r=t.call(this,e)).state={mode:""},r.setMode=r.setMode.bind(Object(B.a)(r)),r}return Object(N.a)(a,[{key:"setMode",value:function(e){this.setState({mode:e})}},{key:"render",value:function(){return Object(g.jsxs)("div",{className:"menu",children:[Object(g.jsx)("h1",{children:"Menu"}),Object(g.jsx)(T,{setMode:this.setMode}),Object(g.jsx)(F,{setMode:this.setMode}),"Demo"===this.state.mode?Object(g.jsx)(A,{}):Object(g.jsx)(g.Fragment,{}),"CustomRoom"===this.state.mode?Object(g.jsx)(G,{room_name:"Game1",player_list:["Paul","Alice","Sun","Jason"],player_num:4}):Object(g.jsx)(g.Fragment,{})]})}}]),a}(n.a.Component);var V=function(){var e=n.a.useState(sessionStorage.getItem("userID")),t=Object(o.a)(e,2),a=t[0],r=t[1],s=n.a.useState(sessionStorage.getItem("username")),i=Object(o.a)(s,2),u=i[0],h=i[1];return Object(g.jsxs)("div",{children:[Object(g.jsx)(I,{userID:a,username:u,setUserID:r,setUsername:h}),Object(g.jsx)(c.a,{fluid:!0,children:Object(g.jsxs)(l.a,{children:[Object(g.jsx)(d.a,{children:Object(g.jsx)(W,{})}),Object(g.jsx)(d.a,{children:Object(g.jsx)(J,{})})]})})]})};i.a.render(Object(g.jsx)(n.a.StrictMode,{children:Object(g.jsx)(V,{})}),document.getElementById("root"))},79:function(e,t,a){}},[[187,1,2]]]);
//# sourceMappingURL=main.b0394026.chunk.js.map